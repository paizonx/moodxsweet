<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="robots" content="index, follow">
<title>Viral Video - Trending Today</title>

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">

<style>
/* --- THEME VARIABLES --- */
:root {
  --bg-main: #0f0f0f;
  --bg-card: #1f1f1f;
  --text-main: #ffffff;
  --accent: #ff0000;
  --header-h: 60px;
}

* { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
body { margin: 0; background-color: var(--bg-main); color: var(--text-main); font-family: 'Roboto', sans-serif; overflow-x: hidden; }
a { text-decoration: none; color: inherit; }

/* --- HEADER --- */
.header {
  position: fixed; top: 0; left: 0; right: 0; height: var(--header-h);
  background: rgba(15, 15, 15, 0.95); backdrop-filter: blur(10px);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 16px; z-index: 100; border-bottom: 1px solid #333;
}
.logo { font-weight: 900; font-size: 20px; display: flex; align-items: center; gap: 5px; cursor: pointer; }
.logo span { color: var(--accent); }

/* --- GRID GALLERY --- */
.container { 
  max-width: 1400px; margin: 0 auto; 
  padding: calc(var(--header-h) + 15px) 15px 40px 15px; 
}

.filter-scroll { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 15px; scrollbar-width: none; }
.pill { background: #272727; padding: 8px 16px; border-radius: 8px; font-size: 14px; white-space: nowrap; cursor: pointer; border: 1px solid #333; }
.pill.active { background: #f1f1f1; color: black; font-weight: 600; }

.grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 12px; row-gap: 24px;
}

.card { cursor: pointer; position: relative; transition: transform 0.2s; }
.card:hover { transform: translateY(-4px); }

.poster {
  width: 100%; aspect-ratio: 9/14;
  background: #1a1a1a; border-radius: 10px; overflow: hidden;
  position: relative;
}

.thumb-media { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 0.5s; }
.thumb-media.loaded { opacity: 1; }

.views-pill { position: absolute; bottom: 8px; left: 8px; background: rgba(0,0,0,0.6); padding: 2px 6px; border-radius: 4px; font-size: 11px; }

.meta { margin-top: 10px; }
.title { font-size: 14px; font-weight: 500; line-height: 1.3; color: #eee; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

/* --- PLAYER PAGE --- */
#playerPage { display: none; padding-top: var(--header-h); }
.p-container { max-width: 1000px; margin: 0 auto; padding: 20px; }

.vid-box { 
  width: 100%; aspect-ratio: 16/9; background: #000; 
  border-radius: 12px; overflow: hidden; position: relative; 
}
.vid-box.vertical { aspect-ratio: 9/16; max-width: 400px; margin: 0 auto; }

/* Perbaikan: Overlay hanya muncul sekali saja jika dibutuhkan, 
atau dihapus agar user bisa langsung klik play tanpa iklan popup */
video, iframe { width: 100%; height: 100%; border: none; }
.hidden { display: none !important; }

.p-info { margin-top: 20px; }
.p-title { font-size: 20px; font-weight: 700; margin-bottom: 10px; }
.p-actions { display: flex; gap: 10px; margin-top: 15px; border-bottom: 1px solid #333; padding-bottom: 20px; }
.btn { flex: 1; padding: 12px; border-radius: 30px; border: none; font-weight: 600; cursor: pointer; font-size: 14px; text-align: center;}
.btn-dl { background: white; color: black; }
.btn-share { background: #333; color: white; }

.ad-slot { margin: 20px 0; min-height: 100px; display: flex; align-items: center; justify-content: center; background: #050505; border-radius: 8px;}

@media (max-width: 768px) { .grid { grid-template-columns: repeat(2, 1fr); } }
</style>
</head>
<body>

<div class="header">
  <div class="logo" onclick="window.location.href=window.location.pathname">Viral<span>Video</span></div>
</div>

<div class="container" id="galleryPage">
  <div class="filter-scroll">
    <div class="pill active" onclick="loadCategory('videos.txt', this)">Trending</div>
    <div class="pill" onclick="loadCategory('usa.txt', this)">Hot USA</div>
  </div>
  <div id="statusMsg" style="text-align:center; padding:40px; color:#666;">Loading...</div>
  <div class="grid" id="gridTarget"></div>
</div>

<div id="playerPage">
  <div class="p-container">
    <div onclick="window.location.href=window.location.pathname" style="cursor:pointer; color:#aaa; font-size:14px; margin-bottom:15px;">&larr; Back to Feed</div>
    
    <div class="vid-box" id="shell">
      <video id="vid" controls playsinline class="hidden"></video>
      <iframe id="frame" allow="autoplay; fullscreen" allowfullscreen class="hidden"></iframe>
    </div>

    <div class="p-info">
      <h1 class="p-title" id="vidTitle">Loading Video...</h1>
      
      <div class="ad-slot">
         <div id="container-b94cafeb9a426597e421e6c2d836a415"></div>
      </div>

      <div class="p-actions">
        <button class="btn btn-dl" onclick="window.open(ADS_LINK)">Download HD</button>
        <button class="btn btn-share" onclick="window.open(ADS_LINK)">Share</button>
      </div>
    </div>
  </div>
</div>

<script>
/* --- CONFIG --- */
const ADS_LINK = "https://thinnerwithdrewforbear.com/gcjm4sfz6e?key=f12b44e51f20fb37ba29ae6253bff65a"; 
const HISTATS_ID = "4654540";

const q = new URLSearchParams(location.search);
const vidId = q.get('id');

/* --- INIT --- */
if(vidId) {
  document.getElementById('galleryPage').style.display = 'none';
  document.getElementById('playerPage').style.display = 'block';
  setupPlayer();
  injectAds();
} else {
  loadCategory('videos.txt', document.querySelector('.pill.active'));
}

/* --- LOAD CATEGORY --- */
async function loadCategory(filename, btnElement) {
  const grid = document.getElementById('gridTarget');
  const statusMsg = document.getElementById('statusMsg');
  
  if(btnElement) {
    document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
    btnElement.classList.add('active');
  }

  grid.innerHTML = '';
  statusMsg.style.display = 'block';

  try {
    const res = await fetch(filename + '?t=' + Date.now());
    const text = await res.text();
    const lines = text.split('\n');
    let html = '';

    lines.forEach(line => {
      if(line.trim().length < 3) return;
      const parts = line.split('|');
      const id = parts[0].trim();
      const title = parts[1] || 'Viral Video';
      const views = (Math.random() * 5 + 0.5).toFixed(1) + "M";

      html += `
        <div class="card" onclick="location.href='?id=${id}'">
          <div class="poster">
             <img data-src="https://www.dailymotion.com/thumbnail/video/${id}" class="thumb-media lazy">
             <div class="views-pill">${views} views</div>
          </div>
          <div class="meta"><div class="title">${title}</div></div>
        </div>`;
    });
    grid.innerHTML = html;
    statusMsg.style.display = 'none';
    observeLazy();
  } catch(e) { statusMsg.textContent = "Error loading content."; }
}

function observeLazy() {
  const images = document.querySelectorAll('img.lazy');
  images.forEach(img => {
    img.src = img.dataset.src;
    img.onload = () => img.classList.add('loaded');
  });
}

/* --- PLAYER SETUP --- */
function setupPlayer() {
  const vid = document.getElementById('vid');
  const frame = document.getElementById('frame');
  const shell = document.getElementById('shell');

  if(vidId.length > 9) {
    frame.classList.remove('hidden');
    frame.src = `https://www.dailymotion.com/embed/video/${vidId}?autoplay=1`;
  } else {
    vid.classList.remove('hidden');
    vid.src = `https://cdn.videy.co/${vidId}.mp4`;
    vid.play();
  }
}

/* --- ADS INJECTION --- */
function injectAds() {
  // Native Banner
  const n = document.createElement('script');
  n.src = "https://thinnerwithdrewforbear.com/b94cafeb9a426597e421e6c2d836a415/invoke.js";
  n.async = true;
  document.head.appendChild(n);

  // Histats
  const h = document.createElement('script');
  h.text = `
    var _Hasync= _Hasync|| [];
    _Hasync.push(['Histats.start', '1,${HISTATS_ID},4,0,0,0,00010000']);
    _Hasync.push(['Histats.fasi', '1']);
    _Hasync.push(['Histats.track_hits', '']);
    (function() {
    var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
    hs.src = ('//s10.histats.com/js15_as.js');
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
    })();`;
  document.body.appendChild(h);
}
</script>
</body>
</html>
