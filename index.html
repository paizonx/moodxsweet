<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Viral Video - Clean Version</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">

<style>
/* --- THEME VARIABLES --- */
:root {
  --bg-main: #0f0f0f;
  --bg-card: #1f1f1f;
  --text-main: #ffffff;
  --accent: #ff0000;
  --header-h: 60px;
}

* { box-sizing: border-box; outline: none; }
body { margin: 0; background-color: var(--bg-main); color: var(--text-main); font-family: 'Roboto', sans-serif; }
a { text-decoration: none; color: inherit; }

/* --- HEADER --- */
.header {
  position: fixed; top: 0; left: 0; right: 0; height: var(--header-h);
  background: rgba(15, 15, 15, 0.95); backdrop-filter: blur(10px);
  display: flex; align-items: center; justify-content: space-between;
  padding: 0 16px; z-index: 100; border-bottom: 1px solid #333;
}
.logo { font-weight: 900; font-size: 20px; color: white; cursor: pointer; }
.logo span { color: var(--accent); }

/* --- CONTAINER & GRID --- */
.container { max-width: 1200px; margin: 0 auto; padding: calc(var(--header-h) + 20px) 15px; }
.grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; }

.card { cursor: pointer; background: var(--bg-card); border-radius: 12px; overflow: hidden; transition: 0.3s; }
.card:hover { transform: scale(1.02); }

.poster { width: 100%; aspect-ratio: 9/14; position: relative; background: #000; }
.thumb-media { width: 100%; height: 100%; object-fit: cover; }

.meta { padding: 10px; }
.title { font-size: 14px; font-weight: 500; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }

/* --- PLAYER PAGE --- */
#playerPage { display: none; padding-top: var(--header-h); }
.p-container { max-width: 800px; margin: 0 auto; padding: 20px; }
.vid-box { width: 100%; aspect-ratio: 16/9; background: #000; border-radius: 12px; overflow: hidden; }
.vid-box.vertical { aspect-ratio: 9/16; max-width: 350px; margin: 0 auto; }

video, iframe { width: 100%; height: 100%; border: none; }
.hidden { display: none !important; }

.p-info { margin-top: 20px; }
.p-actions { display: flex; gap: 10px; margin-top: 20px; }
.btn { flex: 1; padding: 12px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; text-align: center; }
.btn-dl { background: #fff; color: #000; }
.btn-share { background: #333; color: #fff; }

@media (max-width: 600px) {
  .grid { grid-template-columns: repeat(2, 1fr); }
}
</style>
</head>
<body>

<div class="header">
  <div class="logo" onclick="location.href=location.pathname">Viral<span>Video</span></div>
</div>

<div class="container" id="galleryPage">
  <div id="statusMsg" style="text-align:center; padding:20px;">Loading viral content...</div>
  <div class="grid" id="gridTarget"></div>
</div>

<div id="playerPage">
  <div class="p-container">
    <div onclick="location.href=location.pathname" style="cursor:pointer; color:#aaa; margin-bottom:15px;">&larr; Back to Feed</div>
    
    <div class="vid-box" id="shell">
      <video id="vid" controls playsinline class="hidden"></video>
      <iframe id="frame" allow="autoplay;页面 fullscreen" allowfullscreen class="hidden"></iframe>
    </div>

    <div class="p-info">
      <h1 class="p-title" id="vidTitle">Video Title</h1>
      <div class="p-actions">
        <button class="btn btn-dl" id="dlBtn">Download</button>
        <button class="btn btn-share" id="shareBtn">Share Video</button>
      </div>
    </div>
  </div>
</div>

<script>
const q = new URLSearchParams(location.search);
const vidId = q.get('id');

// Fungsi Load Data
async function loadContent() {
    const grid = document.getElementById('gridTarget');
    try {
        const res = await fetch('videos.txt'); // Ganti sesuai file anda
        const text = await res.text();
        const lines = text.split('\n');
        
        let html = '';
        lines.forEach(line => {
            if(line.trim().length < 5) return;
            const [id, title] = line.split('|');
            html += `
                <div class="card" onclick="location.href='?id=${id.trim()}'">
                    <div class="poster">
                        <img src="https://www.dailymotion.com/thumbnail/video/${id.trim()}" class="thumb-media">
                    </div>
                    <div class="meta"><div class="title">${title || 'Viral Video'}</div></div>
                </div>`;
        });
        document.getElementById('statusMsg').style.display = 'none';
        grid.innerHTML = html;
    } catch (e) {
        document.getElementById('statusMsg').textContent = "Failed to load videos.";
    }
}

// Setup Player Tanpa Iklan Paksa
function setupPlayer() {
    const vid = document.getElementById('vid');
    const frame = document.getElementById('frame');
    const shell = document.getElementById('shell');

    if(vidId.length > 9) { // Dailymotion
        frame.classList.remove('hidden');
        frame.src = `https://www.dailymotion.com/embed/video/${vidId}?autoplay=1`;
    } else { // Videy
        vid.classList.remove('hidden');
        vid.src = `https://cdn.videy.co/${vidId}.mp4`;
    }
    
    // Share Functionality (Asli)
    document.getElementById('shareBtn').onclick = () => {
        if (navigator.share) {
            navigator.share({ title: 'Watch this video', url: window.location.href });
        } else {
            alert("Link copied to clipboard!");
        }
    };
}

// Router
if(vidId) {
    document.getElementById('galleryPage').style.display = 'none';
    document.getElementById('playerPage').style.display = 'block';
    setupPlayer();
} else {
    loadContent();
}
</script>

</body>
</html>
