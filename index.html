<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="referrer" content="no-referrer">
<meta name="robots" content="index, follow">

<meta property="og:title" content="MovieStream Premium">
<meta property="og:description" content="Nonton Film & Video Viral Terbaru">
<meta property="og:type" content="website">

<title>MovieStream Premium</title>
<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
/* --- TMDB DARK THEME --- */
:root {
  --bg-main: #0d253f;
  --bg-header: #032541;
  --text-main: #ffffff;
  --text-muted: #b5c2cd;
  --accent: #01b4e4;
  --accent-green: #90cea1;
  --card-width: 160px; /* Lebar Poster TMDB */
}

* { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
body { margin: 0; background-color: var(--bg-main); color: var(--text-main); font-family: 'Source Sans Pro', sans-serif; overflow-x: hidden; }
a { text-decoration: none; color: inherit; }

/* HEADER TMDB STYLE */
.header {
  height: 64px; background: var(--bg-header); display: flex; align-items: center; justify-content: space-between; padding: 0 40px;
  position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.3);
}
.logo { font-weight: 700; font-size: 24px; background: linear-gradient(to right, #90cea1, #01b4e4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; cursor: pointer; letter-spacing: 1px; }
.nav-menu { display: flex; gap: 20px; font-weight: 600; font-size: 14px; }
.nav-item { cursor: pointer; color: #fff; }

/* LAYOUT GRID PORTRAIT (TMDB) */
.container { max-width: 1300px; margin: 0 auto; padding: 30px 20px; }
.section-title { font-size: 24px; font-weight: 700; margin-bottom: 20px; border-left: 4px solid var(--accent); padding-left: 15px; }

.grid-poster {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); /* Responsif Poster */
  gap: 25px;
  row-gap: 35px;
}

/* MOVIE CARD DESIGN */
.movie-card { position: relative; cursor: pointer; transition: transform 0.2s; }
.movie-card:hover { transform: translateY(-5px); }

.poster-box {
  width: 100%;
  aspect-ratio: 2/3; /* Rasio Portrait Standar Poster Bioskop */
  border-radius: 10px;
  overflow: hidden;
  background: #000;
  position: relative;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
}
.poster-img { width: 100%; height: 100%; object-fit: cover; opacity: 0.9; transition: opacity 0.2s; }
.movie-card:hover .poster-img { opacity: 1; }

.rating-circle {
  position: absolute; bottom: -15px; left: 10px;
  width: 34px; height: 34px; background: #081c22;
  border-radius: 50%; border: 2px solid var(--accent-green);
  display: flex; align-items: center; justify-content: center;
  font-size: 12px; font-weight: bold; color: #fff;
  box-shadow: 0 2px 5px rgba(0,0,0,0.5); z-index: 5;
}
.rating-sup { font-size: 8px; margin-top: -3px; }

.card-info { margin-top: 20px; padding: 0 5px; }
.movie-title { font-weight: 700; font-size: 15px; line-height: 1.2; margin-bottom: 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
.movie-date { font-size: 13px; color: var(--text-muted); font-weight: 300; }

/* PLAYER PAGE STYLES */
#playerPage { display: none; margin-top: 20px; }
.player-container { max-width: 1000px; margin: 0 auto; padding: 0 20px; }

/* Wrapper Video dengan Overlay Pintar */
.video-wrapper { 
  position: relative; width: 100%; background: #000; 
  aspect-ratio: 16/9; border-radius: 12px; overflow: hidden; 
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
}
.video-wrapper.vertical { aspect-ratio: 9/16; max-width: 400px; margin: 0 auto; }

iframe, video { width: 100%; height: 100%; border: none; }

/* FULL CUAN OVERLAY (Tombol Play Palsu) */
.ads-overlay {
  position: absolute; inset: 0; z-index: 50;
  background: rgba(0,0,0,0.3);
  display: flex; align-items: center; justify-content: center;
  cursor: pointer;
}
.fake-play-btn {
  width: 70px; height: 70px; background: rgba(255,0,0,0.9);
  border-radius: 50%; display: flex; align-items: center; justify-content: center;
  box-shadow: 0 0 20px rgba(0,0,0,0.5);
  transition: transform 0.2s;
}
.fake-play-btn svg { fill: white; width: 35px; height: 35px; margin-left: 4px; }
.ads-overlay:hover .fake-play-btn { transform: scale(1.1); }

.video-meta { margin-top: 20px; background: #102a44; padding: 20px; border-radius: 10px; }
.vid-h1 { font-size: 22px; margin: 0 0 10px 0; color: #fff; }
.btn-dl { 
  display: block; width: 100%; background: var(--accent); color: #fff; 
  text-align: center; padding: 14px; border-radius: 8px; font-weight: 700; margin-top: 15px; cursor: pointer;
  box-shadow: 0 4px 10px rgba(1, 180, 228, 0.3); border:none;
}

/* NATIVE ADS CONTAINER */
.native-ads-box {
  margin: 20px 0; padding: 10px; border: 1px dashed #444; background: #081c22;
  border-radius: 8px; text-align: center; min-height: 120px; display:flex; align-items:center; justify-content:center;
}

/* UTILS */
#statusMsg { padding: 40px; text-align: center; color: var(--text-muted); }
.hidden { display: none !important; }

@media (max-width: 600px) {
  .header { padding: 0 20px; }
  .grid-poster { grid-template-columns: repeat(2, 1fr); gap: 15px; } /* 2 Kolom di HP */
  .poster-box { aspect-ratio: 2/3; }
}
</style>
</head>
<body oncontextmenu="return false;">

<div class="header">
  <div class="logo" onclick="window.location.href=window.location.pathname">MOVIEDB</div>
  <div class="nav-menu">
    <div class="nav-item">Popular</div>
    <div class="nav-item">Trending</div>
  </div>
</div>

<div class="container" id="galleryPage">
  <div class="section-title">Trending Movies</div>
  <div id="statusMsg">Memuat Film...</div>
  <div class="grid-poster" id="gridTarget"></div>
</div>

<div id="playerPage">
  <div class="player-container">
    <div style="margin-bottom:15px; color:var(--accent); cursor:pointer; font-weight:600;" onclick="window.location.href=window.location.pathname">← Back to Home</div>
    
    <div id="shell" class="video-wrapper">
      
      <div class="ads-overlay" id="fakeOverlay" onclick="handleAdClick()">
        <div class="fake-play-btn">
          <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
        </div>
      </div>

      <video id="vid" controls playsinline class="hidden"></video>
      <iframe id="frame" allow="autoplay; fullscreen" allowfullscreen class="hidden"></iframe>
    </div>

    <div class="video-meta">
      <h1 class="vid-h1" id="vidTitle">Loading...</h1>
      <div style="font-size:14px; color:var(--text-muted);">HD Quality • 1080p • Free Streaming</div>
      
      <div class="native-ads-box">
         <div id="container-8754c34f20e587c8ef08a064d9f71e59"></div>
      </div>

      <button class="btn-dl" id="dlBtn">Download Full Movie HD</button>
    </div>

  </div>
</div>

<div id="histats_counter" style="display:none;"></div>

<script>
/* --- SETTINGS --- */
const ADS_DIRECT = "https://ridernoodleacerbity.com/pu4v8n14t?key=280fea026bf240b90dd4b3343468c40f";
const HISTATS_ID = "4879497";

const q = new URLSearchParams(location.search);
const vidId = q.get('id');

/* --- SECURITY --- */
document.addEventListener('keydown', e => {
  if(e.ctrlKey && (e.key==='u'||e.key==='U')) e.preventDefault();
  if(e.key==='F12') e.preventDefault();
});

/* --- INIT --- */
if(vidId) {
  // MODE PLAYER (ADA IKLAN)
  document.getElementById('galleryPage').classList.add('hidden');
  document.getElementById('playerPage').style.display = 'block';
  
  initPlayer();
  injectAds(); // IKLAN HANYA DI SINI
} else {
  // MODE GALLERY (BERSIH TANPA IKLAN)
  document.getElementById('galleryPage').style.display = 'block';
  loadVideos();
}

/* --- LOGIC FULL CUAN --- */
function handleAdClick() {
  // 1. Buka Iklan Direct Link di Tab Baru
  window.open(ADS_DIRECT, '_blank');
  
  // 2. Hilangkan Overlay Palsu
  const overlay = document.getElementById('fakeOverlay');
  overlay.style.display = 'none';
  
  // 3. Mainkan Video (Autoplay)
  const vid = document.getElementById('vid');
  const frame = document.getElementById('frame');
  
  if(!vid.classList.contains('hidden')) {
    vid.muted = false; // Unmute
    vid.play();
  } else if(!frame.classList.contains('hidden')) {
    // Refresh iframe dgn autoplay jika perlu, atau biarkan user klik play asli
    const src = frame.src;
    frame.src = src; // reload trick for iframe autoplay
  }
}

/* --- DATA LOADER --- */
async function loadVideos() {
  try {
    const res = await fetch('videos.txt?t=' + Date.now());
    if(!res.ok) throw new Error("Gagal baca data");
    const text = await res.text();
    const lines = text.split('\n');
    let html = '';

    lines.forEach(line => {
      if(line.trim().length < 3 || line.startsWith('[')) return;
      const p = line.split('|');
      const id = p[0].trim();
      const title = p[1] ? p[1].trim() : 'Video Viral';
      
      // Generate Fake Rating acak (70% - 98%) agar terlihat seperti TMDB
      const rating = Math.floor(Math.random() * (98 - 70 + 1)) + 70;
      
      // Thumbnail Logic: Videy/Twing default thumb adalah 16:9
      // CSS object-fit: cover akan memotongnya jadi Portrait (Poster) otomatis
      let thumb = `https://cdn.videy.co/${id}.jpg`;
      if(id.length > 9 || id.startsWith('k')) thumb = `https://www.dailymotion.com/thumbnail/video/${id}`;

      html += `
        <div class="movie-card" onclick="location.href='?id=${id}'">
          <div class="poster-box">
            <img src="${thumb}" class="poster-img" loading="lazy" onerror="this.src='https://via.placeholder.com/200x300?text=No+Image'">
            <div class="rating-circle">${rating}<span class="rating-sup">%</span></div>
          </div>
          <div class="card-info">
            <div class="movie-title">${title}</div>
            <div class="movie-date">2024</div>
          </div>
        </div>
      `;
    });

    document.getElementById('gridTarget').innerHTML = html;
    document.getElementById('statusMsg').style.display = 'none';

  } catch(e) {
    document.getElementById('statusMsg').innerHTML = "Error memuat daftar.";
  }
}

/* --- PLAYER LOGIC --- */
function initPlayer() {
  const vid = document.getElementById('vid');
  const frame = document.getElementById('frame');
  const shell = document.getElementById('shell');

  // Tombol Download -> Direct Link
  document.getElementById('dlBtn').onclick = () => window.open(ADS_DIRECT, '_blank');

  // Judul Sementara
  document.getElementById('vidTitle').innerText = "Playing Video...";
  // (Optional) Fetch ulang videos.txt untuk cari judul asli berdasarkan ID jika mau

  if(vidId.length > 9 || vidId.startsWith('k')) {
    // Dailymotion
    frame.classList.remove('hidden');
    checkDmRatio(vidId);
    // Tambahkan mute=1 agar autoplay jalan di background (menunggu klik overlay)
    frame.src = `https://www.dailymotion.com/embed/video/${vidId}?autoplay=1&mute=1&controls=1`;
  } else {
    // Videy / Twing
    vid.classList.remove('hidden');
    // Format standar mp4
    vid.src = `https://cdn.videy.co/${vidId}.mp4`;
    vid.load();
    vid.muted = true; // Mute awal
    // Deteksi Vertical
    vid.onloadedmetadata = function() {
      if(this.videoHeight > this.videoWidth) shell.classList.add('vertical');
    };
    vid.onerror = function() {
        // Fallback Twing jika Videy 404
        // vid.src = `https://cdn.video.twing.cc/${vidId}.mp4`; 
    };
  }
}

async function checkDmRatio(id) {
  try {
    const r = await fetch(`https://www.dailymotion.com/services/oembed?url=https://www.dailymotion.com/video/${id}`);
    const d = await r.json();
    if(d.height > d.width) document.getElementById('shell').classList.add('vertical');
  } catch(e){}
}

/* --- ADS INJECTOR (Video Page Only) --- */
function injectAds() {
  // 1. Native Banner
  const s1 = document.createElement('script');
  s1.src = "https://ridernoodleacerbity.com/8754c34f20e587c8ef08a064d9f71e59/invoke.js";
  s1.async = true; 
  s1.setAttribute('data-cfasync','false');
  document.head.appendChild(s1);

  // 2. Popunder
  const s2 = document.createElement('script');
  s2.src = "https://ridernoodleacerbity.com/c9/c0/46/c9c04611f8fb3b0b21da4b49fb98d3fa.js";
  document.body.appendChild(s2);

  // 3. Histats
  const hs = document.createElement('script');
  hs.text = `
    var _Hasync= _Hasync|| [];
    _Hasync.push(['Histats.start', '1,${HISTATS_ID},4,0,0,0,00010000']);
    _Hasync.push(['Histats.fasi', '1']);
    _Hasync.push(['Histats.track_hits', '']);
    (function() {
    var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
    hs.src = ('//s10.histats.com/js15_as.js');
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
    })();
  `;
  document.body.appendChild(hs);
}
</script>
</body>
</html>
